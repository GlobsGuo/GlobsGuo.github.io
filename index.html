<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="https://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.58.3" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>My New Hugo Site</title>

  
  <link type="text/css" rel="stylesheet" href="https://github.com/globsguo.github.io/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="https://github.com/globsguo.github.io/css/poole.css">
  <link type="text/css" rel="stylesheet" href="https://github.com/globsguo.github.io/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="https://github.com/globsguo.github.io/css/hyde.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="https://github.com/globsguo.github.io/index.xml" rel="alternate" type="application/rss+xml" title="My New Hugo Site" />
  
</head>

  <body class=" ">
  <aside class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://github.com/globsguo.github.io/"><h1>My New Hugo Site</h1></a>
      <p class="lead">
      An elegant open source and mobile first theme for <a href="http://hugo.spf13.com">hugo</a> made by <a href="http://twitter.com/mdo">@mdo</a>. Originally made for Jekyll.
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li><a href="https://github.com/globsguo.github.io/">Home</a> </li>
        
      </ul>
    </nav>

    <p>&copy; 2019. All rights reserved. </p>
  </div>
</aside>

    <main class="content container">
    <div class="posts">
<article class="post">
  <h1 class="post-title">
    <a href="https://github.com/globsguo.github.io/printk/">printk函数</a>
  </h1>
  <time datetime="0001-01-01T00:00:00Z" class="post-date">Mon, Jan 1, 0001</time>
  1. printk.c中的重要变量 首先介绍一些 kernel/printk/printk.c 中定义的一些十分重要的变量。
/* console_sem用来保护对console_drivers列表的访问 */ static DEFINE_SEMAPHORE(console_sem); /* console_drivers保存所有的控制台驱动，所有的控制台 驱动都调用register_console函数注册到console_drivers 列表中 */ struct console *console_drivers; EXPORT_SYMBOL_GPL(console_drivers); /* 注释说这两个变量用来调试VT代码 */ static int console_locked, console_suspended; /* 如果exclusive_console不是NULL，信息只会输出到这个控制台 */ static struct console *exclusive_console; /* 包含所有的控制台命令行信息，只有__add_preferred_consoles函数 会向其中增加元素，数组长度为8 */ static struct cmdline_console console_cmdline[MAX_CMDLINECONSOLES]; /* 控制台代码可能会调用schedule()标志 */ static int console_may_schedule;  1.1. struct printk_log 上述变量在 register_console 函数中都有涉及，printk日志系统中最重要的结构体是 struct printk_log ：
struct printk_log { u64 ts_nsec; /* 时间戳，ns计 */ u16 len; /* 整条记录的长度 */ u16 text_len; /* 文本缓冲区的大小 */ u16 dict_len; /* 字典缓冲区的大小 */ u8 facility; /* syslog设备 */ u8 flags:5; /* 内部记录标志 */ u8 level:3; /* syslog等级 */ };  代码中对于 printk_log 的说明如下：
  
  <div class="read-more-link">
    <a href="/globsguo.github.io/printk/">Read More…</a>
  </div>
  
</article>
</div>
    </main>

    
  </body>
</html>
